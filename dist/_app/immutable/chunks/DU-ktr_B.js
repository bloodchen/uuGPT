import{c}from"./BA1YXEPc.js";import{b as h}from"./MpRaoTL8.js";import{u as g,l as b}from"./BtGMJFbd.js";import{w as d}from"./BhusnUZQ.js";import{d as _,$ as w,l as C,b as L}from"./CLpZC9pY.js";var m=function(i,e){if(!(this instanceof m))return new m(i,e);this.INITIALIZING=-1,this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,this.url=i,e=e||{},this.headers=e.headers||{},this.payload=e.payload!==void 0?e.payload:"",this.method=e.method||this.payload&&"POST"||"GET",this.withCredentials=!!e.withCredentials,this.debug=!!e.debug,this.FIELD_SEPARATOR=":",this.listeners={},this.xhr=null,this.readyState=this.INITIALIZING,this.progress=0,this.chunk="",this.lastEventId="",this.addEventListener=function(t,s){this.listeners[t]===void 0&&(this.listeners[t]=[]),this.listeners[t].indexOf(s)===-1&&this.listeners[t].push(s)},this.removeEventListener=function(t,s){if(this.listeners[t]===void 0)return;const a=[];this.listeners[t].forEach(function(n){n!==s&&a.push(n)}),a.length===0?delete this.listeners[t]:this.listeners[t]=a},this.dispatchEvent=function(t){if(!t)return!0;this.debug&&console.debug(t),t.source=this;const s="on"+t.type;return this.hasOwnProperty(s)&&(this[s].call(this,t),t.defaultPrevented)?!1:this.listeners[t.type]?this.listeners[t.type].every(function(a){return a(t),!t.defaultPrevented}):!0},this._setReadyState=function(t){const s=new CustomEvent("readystatechange");s.readyState=t,this.readyState=t,this.dispatchEvent(s)},this._onStreamFailure=function(t){const s=new CustomEvent("error");s.responseCode=this.xhr.status,s.data=t.currentTarget.response,this.dispatchEvent(s),this.close()},this._onStreamAbort=function(){this.dispatchEvent(new CustomEvent("abort")),this.close()},this._onStreamProgress=function(t){if(!this.xhr)return;if(this.xhr.status!==200){this._onStreamFailure(t);return}const s=this.xhr.responseText.substring(this.progress);this.progress+=s.length;const a=(this.chunk+s).split(/(\r\n\r\n|\r\r|\n\n)/g),n=a.pop();a.forEach((function(o){o.trim().length>0&&this.dispatchEvent(this._parseEventChunk(o))}).bind(this)),this.chunk=n},this._onStreamLoaded=function(t){this._onStreamProgress(t),this.dispatchEvent(this._parseEventChunk(this.chunk)),this.chunk=""},this._parseEventChunk=function(t){if(!t||t.length===0)return null;this.debug&&console.debug(t);const s={id:null,retry:null,data:null,event:null};t.split(/\n|\r\n|\r/).forEach((function(n){const o=n.indexOf(this.FIELD_SEPARATOR);let l,u;if(o>0){const v=n[o+1]===" "?2:1;l=n.substring(0,o),u=n.substring(o+v)}else if(o<0)l=n,u="";else return;l in s&&(l==="data"&&s[l]!==null?s.data+=`
`+u:s[l]=u)}).bind(this)),s.id!==null&&(this.lastEventId=s.id);const a=new CustomEvent(s.event||"message");return a.id=s.id,a.data=s.data||"",a.lastEventId=this.lastEventId,a},this._onReadyStateChange=function(){if(this.xhr)if(this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){const t={},s=this.xhr.getAllResponseHeaders().trim().split(`\r
`);for(const n of s){const[o,...l]=n.split(":"),u=l.join(":").trim();t[o.trim().toLowerCase()]=t[o.trim().toLowerCase()]||[],t[o.trim().toLowerCase()].push(u)}const a=new CustomEvent("open");a.responseCode=this.xhr.status,a.headers=t,this.dispatchEvent(a),this._setReadyState(this.OPEN)}else this.xhr.readyState===XMLHttpRequest.DONE&&this._setReadyState(this.CLOSED)},this.stream=function(){if(!this.xhr){this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._onReadyStateChange.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamAbort.bind(this)),this.xhr.open(this.method,this.url);for(let t in this.headers)this.xhr.setRequestHeader(t,this.headers[t]);this.lastEventId.length>0&&this.xhr.setRequestHeader("Last-Event-ID",this.lastEventId),this.xhr.withCredentials=this.withCredentials,this.xhr.send(this.payload)}},this.close=function(){this.readyState!==this.CLOSED&&(this.xhr.abort(),this.xhr=null,this._setReadyState(this.CLOSED))},(e.start===void 0||e.start)&&this.stream()};typeof exports<"u"&&(exports.SSE=m);const y=d([]),R=d([]),E=d(0),j=d(""),D=d(!1),r=[{ai:"openai",aiName:"GPT",models:[{model:"gpt-4o-mini",name:"4o-mini",price:"Lite"},{model:"gpt-4o",name:"4o",price:"Balanced"},{model:"o1",name:"o1",price:"Elite"},{model:"o1-mini",name:"o1-mini",price:"Balanced"},{model:"o3-mini",name:"o3-mini",price:"Balanced"}]},{ai:"anthropic",aiName:"Claude",models:[{model:"claude-3.5-haiku",name:"3.5 haiku",price:"Balanced"},{model:"claude-3.5-sonnet",name:"3.5 sonnet",price:"Balanced"},{model:"claude-3.7-sonnet",name:"3.7 sonnet",price:"Elite"}]},{ai:"google",aiName:"Gemini",models:[{model:"gemini-2.0-flash-lite-001",name:"2.0 flash lite",price:"Lite"},{model:"gemini-flash-1.5",name:"1.5 flash",price:"Lite"},{model:"gemini-2.0-flash-001",name:"2.0 flash",price:"Lite"},{model:"gemini-pro-1.5",name:"1.5 pro",price:"Balanced"}]},{ai:"deepseek",aiName:"Deepseek",models:[{model:"deepseek-chat:free",name:"V3",price:"Lite"},{model:"deepseek-r1:free",name:"R1",price:"Lite"}]},{ai:"qwen",aiName:"Qwen",models:[{model:"qwen-plus",name:"Plus",price:"Balanced"}]}],f=d(r[0].ai),p=d(r[0].models[0].model),x=d(""),S=d("");f.subscribe(i=>{for(let e=0;e<r.length;e++)if(r[e].ai==i){x.set(r[e].aiName),S.set(r[e].models[0].name);break}});p.subscribe(i=>{var e;for(let t=0;t<r.length;t++)if(r[t].models.find(s=>s.model==i)){S.set(((e=r[t].models.find(s=>s.model==i))==null?void 0:e.name)||r[t].models[0].name);break}});E.subscribe(i=>{i==0&&I();let e=h(y);for(let t=0;t<e.length;t++){let s=e[t];if(s.cid==i){f.set(s.ai),p.set(s.model);break}}});function I(){f.set(r[0].ai),p.set(r[0].models[0].model)}function A(i){for(let e=0;e<r.length;e++)if(r[e].ai==i)return r[e].aiName}function q(i){var e;for(let t=0;t<r.length;t++)if(r[t].models.find(s=>s.model==i))return(e=r[t].models.find(s=>s.model==i))==null?void 0:e.name}function B(i){let e=h(y);for(let t=0;t<e.length;t++)if(e[t].cid==i)return t}m.prototype.timeoutId=null;m.prototype.resetTimeout=function(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.close(),_.set(!1)},20*1e3)};async function H(){try{let i=await c()(`https://api.uugpt.com/ai/conv/list?uid=${h(g)}`);return i.ok?await i.json():1}catch{return 1}}async function M(i){try{let e=await c()(`https://api.uugpt.com/ai/conv/get?cid=${i}`);return e.ok?await e.json():1}catch{return 1}}async function $(i,e,t,s,a=[]){let n={ai:t,model:s,system:h(w)("aisystem2"),uid:h(g),message:{role:"user",content:i},did:h(C),lan:h(b)};return h(L)&&Object.assign(n,{messages:a}),Object.assign(n,{cid:h(E),pid:e}),new m("https://api.uugpt.com/ai/stream2",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(n)})}async function G(i){try{let e=await c()(`https://api.uugpt.com/ai/conv/delete?cid=${i}`);return e.ok?await e.json():1}catch{return 1}}async function F(i,e="",t="",s=""){try{let a={cid:i};e!=""&&Object.assign(a,{name:e}),t!=""&&s!=""&&Object.assign(a,{ai:t,model:s});let n=await c()("https://api.uugpt.com/ai/conv/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return n.ok?await n.json():1}catch{return 1}}async function J(i,e,t=!1){try{let s=await c()(`https://api.uugpt.com/ai/msg/delete?cid=${i}&mid=${e}&toEnd=${t}`);return s.ok?await s.json():1}catch{return 1}}async function X(i){try{let e=await c()("https://api.uugpt.com/ai/msg/getShared",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mids:i})});if(e.ok){const t=await e.json();return console.log(t),t}else return 1}catch{return 1}}async function U(i){try{let e=await c()("https://api.uugpt.com/ai/msg/share",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mids:i})});return e.ok?await e.json():1}catch{return 1}}async function V(i){try{let e=await c()("https://api.uugpt.com/ai/shortenUrl",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({url:i})});return e.ok?await e.json():1}catch{return 1}}export{m as S,E as a,M as b,y as c,R as d,X as e,j as f,H as g,I as h,f as i,p as j,B as k,U as l,V as m,G as n,J as o,D as p,x as q,S as r,$ as s,A as t,F as u,q as v,r as w};
