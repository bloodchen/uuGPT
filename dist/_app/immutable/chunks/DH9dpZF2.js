import{c}from"./DZVv445Z.js";import{b as h}from"./BuFKiBdU.js";import{u as g,l as b}from"./Ku0puiqU.js";import{w as d}from"./DIP_aZpm.js";import{d as _,$ as w,l as C,b as L}from"./C4KbiJZZ.js";var m=function(i,t){if(!(this instanceof m))return new m(i,t);this.INITIALIZING=-1,this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,this.url=i,t=t||{},this.headers=t.headers||{},this.payload=t.payload!==void 0?t.payload:"",this.method=t.method||this.payload&&"POST"||"GET",this.withCredentials=!!t.withCredentials,this.debug=!!t.debug,this.FIELD_SEPARATOR=":",this.listeners={},this.xhr=null,this.readyState=this.INITIALIZING,this.progress=0,this.chunk="",this.lastEventId="",this.addEventListener=function(e,s){this.listeners[e]===void 0&&(this.listeners[e]=[]),this.listeners[e].indexOf(s)===-1&&this.listeners[e].push(s)},this.removeEventListener=function(e,s){if(this.listeners[e]===void 0)return;const n=[];this.listeners[e].forEach(function(a){a!==s&&n.push(a)}),n.length===0?delete this.listeners[e]:this.listeners[e]=n},this.dispatchEvent=function(e){if(!e)return!0;this.debug&&console.debug(e),e.source=this;const s="on"+e.type;return this.hasOwnProperty(s)&&(this[s].call(this,e),e.defaultPrevented)?!1:this.listeners[e.type]?this.listeners[e.type].every(function(n){return n(e),!e.defaultPrevented}):!0},this._setReadyState=function(e){const s=new CustomEvent("readystatechange");s.readyState=e,this.readyState=e,this.dispatchEvent(s)},this._onStreamFailure=function(e){const s=new CustomEvent("error");s.responseCode=this.xhr.status,s.data=e.currentTarget.response,this.dispatchEvent(s),this.close()},this._onStreamAbort=function(){this.dispatchEvent(new CustomEvent("abort")),this.close()},this._onStreamProgress=function(e){if(!this.xhr)return;if(this.xhr.status!==200){this._onStreamFailure(e);return}const s=this.xhr.responseText.substring(this.progress);this.progress+=s.length;const n=(this.chunk+s).split(/(\r\n\r\n|\r\r|\n\n)/g),a=n.pop();n.forEach((function(o){o.trim().length>0&&this.dispatchEvent(this._parseEventChunk(o))}).bind(this)),this.chunk=a},this._onStreamLoaded=function(e){this._onStreamProgress(e),this.dispatchEvent(this._parseEventChunk(this.chunk)),this.chunk=""},this._parseEventChunk=function(e){if(!e||e.length===0)return null;this.debug&&console.debug(e);const s={id:null,retry:null,data:null,event:null};e.split(/\n|\r\n|\r/).forEach((function(a){const o=a.indexOf(this.FIELD_SEPARATOR);let l,u;if(o>0){const v=a[o+1]===" "?2:1;l=a.substring(0,o),u=a.substring(o+v)}else if(o<0)l=a,u="";else return;l in s&&(l==="data"&&s[l]!==null?s.data+=`
`+u:s[l]=u)}).bind(this)),s.id!==null&&(this.lastEventId=s.id);const n=new CustomEvent(s.event||"message");return n.id=s.id,n.data=s.data||"",n.lastEventId=this.lastEventId,n},this._onReadyStateChange=function(){if(this.xhr)if(this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){const e={},s=this.xhr.getAllResponseHeaders().trim().split(`\r
`);for(const a of s){const[o,...l]=a.split(":"),u=l.join(":").trim();e[o.trim().toLowerCase()]=e[o.trim().toLowerCase()]||[],e[o.trim().toLowerCase()].push(u)}const n=new CustomEvent("open");n.responseCode=this.xhr.status,n.headers=e,this.dispatchEvent(n),this._setReadyState(this.OPEN)}else this.xhr.readyState===XMLHttpRequest.DONE&&this._setReadyState(this.CLOSED)},this.stream=function(){if(!this.xhr){this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._onReadyStateChange.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamAbort.bind(this)),this.xhr.open(this.method,this.url);for(let e in this.headers)this.xhr.setRequestHeader(e,this.headers[e]);this.lastEventId.length>0&&this.xhr.setRequestHeader("Last-Event-ID",this.lastEventId),this.xhr.withCredentials=this.withCredentials,this.xhr.send(this.payload)}},this.close=function(){this.readyState!==this.CLOSED&&(this.xhr.abort(),this.xhr=null,this._setReadyState(this.CLOSED))},(t.start===void 0||t.start)&&this.stream()};typeof exports<"u"&&(exports.SSE=m);const y=d([]),R=d([]),E=d(0),j=d(""),D=d(!1),r=[{ai:"openai",aiName:"GPT",models:[{model:"gpt-4o-mini",name:"4o-mini",price:"Lite"},{models:"gpt-4.1-mini",name:"4.1-mini",price:"Lite"},{model:"gpt-4.1-nano",name:"4.1 nano",price:"Lite"},{model:"gpt-4o",name:"4o",price:"Balanced"},{model:"gpt-4.1",name:"4.1",price:"Balanced"},{model:"o1",name:"o1",price:"Elite"},{model:"o1-mini",name:"o1-mini",price:"Balanced"},{model:"o3-mini",name:"o3-mini",price:"Balanced"},{model:"o3",name:"o3",price:"Elite"}]},{ai:"anthropic",aiName:"Claude",models:[{model:"claude-3.5-haiku",name:"3.5 haiku",price:"Balanced"},{model:"claude-3.5-sonnet",name:"3.5 sonnet",price:"Balanced"},{model:"claude-4-sonnet",name:"4 sonnet",price:"Balanced"},{model:"claude-3.7-sonnet",name:"3.7 sonnet",price:"Balanced"},{model:"claude-opus-4",name:"4 opus",price:"Elite"},{model:"claude-3.7-sonnet:thinking",name:"3.7 thinking",price:"Elite"}]},{ai:"google",aiName:"Gemini",models:[{model:"gemini-2.0-flash-lite-001",name:"2.0 flash lite",price:"Lite"},{model:"gemini-flash-1.5",name:"1.5 flash",price:"Lite"},{model:"gemini-2.0-flash-001",name:"2.0 flash",price:"Lite"},{model:"gemini-pro-1.5",name:"1.5 pro",price:"Balanced"}]},{ai:"deepseek",aiName:"Deepseek",models:[{model:"deepseek-chat:free",name:"V3",price:"Lite"},{model:"deepseek-r1:free",name:"R1",price:"Lite"}]},{ai:"qwen",aiName:"Qwen",models:[{model:"qwen-plus",name:"Plus",price:"Balanced"}]}],f=d(r[0].ai),p=d(r[0].models[0].model),x=d(""),S=d("");f.subscribe(i=>{for(let t=0;t<r.length;t++)if(r[t].ai==i){x.set(r[t].aiName),S.set(r[t].models[0].name);break}});p.subscribe(i=>{var t;for(let e=0;e<r.length;e++)if(r[e].models.find(s=>s.model==i)){S.set(((t=r[e].models.find(s=>s.model==i))==null?void 0:t.name)||r[e].models[0].name);break}});E.subscribe(i=>{i==0&&I();let t=h(y);for(let e=0;e<t.length;e++){let s=t[e];if(s.cid==i){f.set(s.ai),p.set(s.model);break}}});function I(){f.set(r[0].ai),p.set(r[0].models[0].model)}function A(i){for(let t=0;t<r.length;t++)if(r[t].ai==i)return r[t].aiName}function B(i){var t;for(let e=0;e<r.length;e++)if(r[e].models.find(s=>s.model==i))return(t=r[e].models.find(s=>s.model==i))==null?void 0:t.name}function q(i){let t=h(y);for(let e=0;e<t.length;e++)if(t[e].cid==i)return e}m.prototype.timeoutId=null;m.prototype.resetTimeout=function(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.close(),_.set(!1)},20*1e3)};async function H(){try{let i=await c()(`https://api.uugpt.com/ai/conv/list?uid=${h(g)}`);return i.ok?await i.json():1}catch{return 1}}async function M(i){try{let t=await c()(`https://api.uugpt.com/ai/conv/get?cid=${i}`);return t.ok?await t.json():1}catch{return 1}}async function $(i,t,e,s,n=[]){let a={ai:e,model:s,system:h(w)("aisystem2"),uid:h(g),message:{role:"user",content:i},did:h(C),lan:h(b)};return h(L)&&Object.assign(a,{messages:n}),Object.assign(a,{cid:h(E),pid:t}),new m("https://api.uugpt.com/ai/stream2",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(a)})}async function G(i){try{let t=await c()(`https://api.uugpt.com/ai/conv/delete?cid=${i}`);return t.ok?await t.json():1}catch{return 1}}async function F(i,t="",e="",s=""){try{let n={cid:i};t!=""&&Object.assign(n,{name:t}),e!=""&&s!=""&&Object.assign(n,{ai:e,model:s});let a=await c()("https://api.uugpt.com/ai/conv/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return a.ok?await a.json():1}catch{return 1}}async function J(i,t,e=!1){try{let s=await c()(`https://api.uugpt.com/ai/msg/delete?cid=${i}&mid=${t}&toEnd=${e}`);return s.ok?await s.json():1}catch{return 1}}async function X(i){try{let t=await c()("https://api.uugpt.com/ai/msg/getShared",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mids:i})});if(t.ok){const e=await t.json();return console.log(e),e}else return 1}catch{return 1}}async function U(i){try{let t=await c()("https://api.uugpt.com/ai/msg/share",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mids:i})});return t.ok?await t.json():1}catch{return 1}}async function V(i){try{let t=await c()("https://api.uugpt.com/ai/shortenUrl",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({url:i})});return t.ok?await t.json():1}catch{return 1}}export{m as S,E as a,M as b,y as c,R as d,X as e,j as f,H as g,I as h,f as i,p as j,q as k,U as l,V as m,G as n,J as o,D as p,x as q,S as r,$ as s,A as t,F as u,B as v,r as w};
